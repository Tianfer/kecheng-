!function a(r,s,c){function l(e,t){if(!s[e]){if(!r[e]){var i="function"==typeof require&&require;if(!t&&i)return i(e,!0);if(d)return d(e,!0);var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}var o=s[e]={exports:{}};r[e][0].call(o.exports,function(t){return l(r[e][1][t]||t)},o,o.exports,a,r,s,c)}return s[e].exports}for(var d="function"==typeof require&&require,t=0;t<c.length;t++)l(c[t]);return l}({1:[function(t,e,i){!function(){"use strict";function c(o,t){var e;if(t=t||{},this.trackingClick=!1,this.trackingClickStart=0,this.targetElement=null,this.touchStartX=0,this.touchStartY=0,this.lastTouchIdentifier=0,this.touchBoundary=t.touchBoundary||10,this.layer=o,this.tapDelay=t.tapDelay||200,this.tapTimeout=t.tapTimeout||700,!c.notNeeded(o)){for(var i=["onMouse","onClick","onTouchStart","onTouchMove","onTouchEnd","onTouchCancel"],n=this,a=0,r=i.length;a<r;a++)n[i[a]]=s(n[i[a]],n);l&&(o.addEventListener("mouseover",this.onMouse,!0),o.addEventListener("mousedown",this.onMouse,!0),o.addEventListener("mouseup",this.onMouse,!0)),o.addEventListener("click",this.onClick,!0),o.addEventListener("touchstart",this.onTouchStart,!1),o.addEventListener("touchmove",this.onTouchMove,!1),o.addEventListener("touchend",this.onTouchEnd,!1),o.addEventListener("touchcancel",this.onTouchCancel,!1),Event.prototype.stopImmediatePropagation||(o.removeEventListener=function(t,e,i){var n=Node.prototype.removeEventListener;"click"===t?n.call(o,t,e.hijacked||e,i):n.call(o,t,e,i)},o.addEventListener=function(t,e,i){var n=Node.prototype.addEventListener;"click"===t?n.call(o,t,e.hijacked||(e.hijacked=function(t){t.propagationStopped||e(t)}),i):n.call(o,t,e,i)}),"function"==typeof o.onclick&&(e=o.onclick,o.addEventListener("click",function(t){e(t)},!1),o.onclick=null)}function s(t,e){return function(){return t.apply(e,arguments)}}}var t=0<=navigator.userAgent.indexOf("Windows Phone"),l=0<navigator.userAgent.indexOf("Android")&&!t,s=/iP(ad|hone|od)/.test(navigator.userAgent)&&!t,d=s&&/OS 4_\d(_\d)?/.test(navigator.userAgent),u=s&&/OS [6-7]_\d/.test(navigator.userAgent),o=0<navigator.userAgent.indexOf("BB10");c.prototype.needsClick=function(t){switch(t.nodeName.toLowerCase()){case"button":case"select":case"textarea":if(t.disabled)return!0;break;case"input":if(s&&"file"===t.type||t.disabled)return!0;break;case"label":case"iframe":case"video":return!0}return/\bneedsclick\b/.test(t.className)},c.prototype.needsFocus=function(t){switch(t.nodeName.toLowerCase()){case"textarea":return!0;case"select":return!l;case"input":switch(t.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return!1}return!t.disabled&&!t.readOnly;default:return/\bneedsfocus\b/.test(t.className)}},c.prototype.sendClick=function(t,e){var i,n;document.activeElement&&document.activeElement!==t&&document.activeElement.blur(),n=e.changedTouches[0],(i=document.createEvent("MouseEvents")).initMouseEvent(this.determineEventType(t),!0,!0,window,1,n.screenX,n.screenY,n.clientX,n.clientY,!1,!1,!1,!1,0,null),i.forwardedTouchEvent=!0,t.dispatchEvent(i)},c.prototype.determineEventType=function(t){return l&&"select"===t.tagName.toLowerCase()?"mousedown":"click"},c.prototype.focus=function(t){var e;s&&t.setSelectionRange&&0!==t.type.indexOf("date")&&"time"!==t.type&&"month"!==t.type?(e=t.value.length,t.setSelectionRange(e,e)):t.focus()},c.prototype.updateScrollParent=function(t){var e,i;if(!(e=t.fastClickScrollParent)||!e.contains(t)){i=t;do{if(i.scrollHeight>i.offsetHeight){e=i,t.fastClickScrollParent=i;break}i=i.parentElement}while(i)}e&&(e.fastClickLastScrollTop=e.scrollTop)},c.prototype.getTargetElementFromEventTarget=function(t){return t.nodeType===Node.TEXT_NODE?t.parentNode:t},c.prototype.onTouchStart=function(t){var e,i,n;if(1<t.targetTouches.length)return!0;if(e=this.getTargetElementFromEventTarget(t.target),i=t.targetTouches[0],s){if((n=window.getSelection()).rangeCount&&!n.isCollapsed)return!0;if(!d){if(i.identifier&&i.identifier===this.lastTouchIdentifier)return t.preventDefault(),!1;this.lastTouchIdentifier=i.identifier,this.updateScrollParent(e)}}return this.trackingClick=!0,this.trackingClickStart=t.timeStamp,this.targetElement=e,this.touchStartX=i.pageX,this.touchStartY=i.pageY,t.timeStamp-this.lastClickTime<this.tapDelay&&t.preventDefault(),!0},c.prototype.touchHasMoved=function(t){var e=t.changedTouches[0],i=this.touchBoundary;return Math.abs(e.pageX-this.touchStartX)>i||Math.abs(e.pageY-this.touchStartY)>i},c.prototype.onTouchMove=function(t){return this.trackingClick&&(this.targetElement!==this.getTargetElementFromEventTarget(t.target)||this.touchHasMoved(t))&&(this.trackingClick=!1,this.targetElement=null),!0},c.prototype.findControl=function(t){return void 0!==t.control?t.control:t.htmlFor?document.getElementById(t.htmlFor):t.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")},c.prototype.onTouchEnd=function(t){var e,i,n,o,a,r=this.targetElement;if(!this.trackingClick)return!0;if(t.timeStamp-this.lastClickTime<this.tapDelay)return this.cancelNextClick=!0;if(t.timeStamp-this.trackingClickStart>this.tapTimeout)return!0;if(this.cancelNextClick=!1,this.lastClickTime=t.timeStamp,i=this.trackingClickStart,this.trackingClick=!1,this.trackingClickStart=0,u&&(a=t.changedTouches[0],(r=document.elementFromPoint(a.pageX-window.pageXOffset,a.pageY-window.pageYOffset)||r).fastClickScrollParent=this.targetElement.fastClickScrollParent),"label"===(n=r.tagName.toLowerCase())){if(e=this.findControl(r)){if(this.focus(r),l)return!1;r=e}}else if(this.needsFocus(r))return 100<t.timeStamp-i||s&&window.top!==window&&"input"===n?this.targetElement=null:(this.focus(r),this.sendClick(r,t),s&&"select"===n||(this.targetElement=null,t.preventDefault())),!1;return!(!s||d||!(o=r.fastClickScrollParent)||o.fastClickLastScrollTop===o.scrollTop)||(this.needsClick(r)||(t.preventDefault(),this.sendClick(r,t)),!1)},c.prototype.onTouchCancel=function(){this.trackingClick=!1,this.targetElement=null},c.prototype.onMouse=function(t){return!this.targetElement||(!!t.forwardedTouchEvent||(!t.cancelable||(!(!this.needsClick(this.targetElement)||this.cancelNextClick)||(t.stopImmediatePropagation?t.stopImmediatePropagation():t.propagationStopped=!0,t.stopPropagation(),t.preventDefault(),!1))))},c.prototype.onClick=function(t){var e;return this.trackingClick?(this.targetElement=null,!(this.trackingClick=!1)):"submit"===t.target.type&&0===t.detail||((e=this.onMouse(t))||(this.targetElement=null),e)},c.prototype.destroy=function(){var t=this.layer;l&&(t.removeEventListener("mouseover",this.onMouse,!0),t.removeEventListener("mousedown",this.onMouse,!0),t.removeEventListener("mouseup",this.onMouse,!0)),t.removeEventListener("click",this.onClick,!0),t.removeEventListener("touchstart",this.onTouchStart,!1),t.removeEventListener("touchmove",this.onTouchMove,!1),t.removeEventListener("touchend",this.onTouchEnd,!1),t.removeEventListener("touchcancel",this.onTouchCancel,!1)},c.notNeeded=function(t){var e,i,n;if(void 0===window.ontouchstart)return!0;if(i=+(/Chrome\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1]){if(!l)return!0;if(e=document.querySelector("meta[name=viewport]")){if(-1!==e.content.indexOf("user-scalable=no"))return!0;if(31<i&&document.documentElement.scrollWidth<=window.outerWidth)return!0}}if(o&&10<=(n=navigator.userAgent.match(/Version\/([0-9]*)\.([0-9]*)/))[1]&&3<=n[2]&&(e=document.querySelector("meta[name=viewport]"))){if(-1!==e.content.indexOf("user-scalable=no"))return!0;if(document.documentElement.scrollWidth<=window.outerWidth)return!0}return"none"===t.style.msTouchAction||"manipulation"===t.style.touchAction||(!!(27<=+(/Firefox\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1]&&(e=document.querySelector("meta[name=viewport]"))&&(-1!==e.content.indexOf("user-scalable=no")||document.documentElement.scrollWidth<=window.outerWidth))||("none"===t.style.touchAction||"manipulation"===t.style.touchAction))},c.attach=function(t,e){return new c(t,e)},"function"==typeof define&&"object"==typeof define.amd&&define.amd?define(function(){return c}):void 0!==e&&e.exports?(e.exports=c.attach,e.exports.FastClick=c):window.FastClick=c}()},{}],2:[function(t,e,i){var n={isExist:!1,zIndex:11e3,Sploading:null,len:0,creat:function(){var t=document.createElement("div");t.className="loading-wrap",t.id="Sploading",t.innerHTML='<div class="loading"><style>.loading-wrap { display: none; opacity: 0; transition: opacity .1s linear; position: fixed; left: 0; top: 0; width: 100%; height: 100%; z-index: '+this.zIndex+';}.loading { position: fixed; left: 50%; top: 180px; width: 120px; min-height: 120px; margin: 0 0 0 -60px; border-radius: 5px; color: #fff; background: rgba(17, 17, 17, .7); text-align: center; overflow: hidden; }.loading-icon { display: inline-block; width: 38px; height: 38px; margin: 30px 0 0 0; background: transparent url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAiIGhlaWdodD0iMTIwIiB2aWV3Qm94PSIwIDAgMTAwIDEwMCI+PHBhdGggZmlsbD0ibm9uZSIgZD0iTTAgMGgxMDB2MTAwSDB6Ii8+PHJlY3Qgd2lkdGg9IjciIGhlaWdodD0iMjAiIHg9IjQ2LjUiIHk9IjQwIiBmaWxsPSIjRTlFOUU5IiByeD0iNSIgcnk9IjUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDAgLTMwKSIvPjxyZWN0IHdpZHRoPSI3IiBoZWlnaHQ9IjIwIiB4PSI0Ni41IiB5PSI0MCIgZmlsbD0iIzk4OTY5NyIgcng9IjUiIHJ5PSI1IiB0cmFuc2Zvcm09InJvdGF0ZSgzMCAxMDUuOTggNjUpIi8+PHJlY3Qgd2lkdGg9IjciIGhlaWdodD0iMjAiIHg9IjQ2LjUiIHk9IjQwIiBmaWxsPSIjOUI5OTlBIiByeD0iNSIgcnk9IjUiIHRyYW5zZm9ybT0icm90YXRlKDYwIDc1Ljk4IDY1KSIvPjxyZWN0IHdpZHRoPSI3IiBoZWlnaHQ9IjIwIiB4PSI0Ni41IiB5PSI0MCIgZmlsbD0iI0EzQTFBMiIgcng9IjUiIHJ5PSI1IiB0cmFuc2Zvcm09InJvdGF0ZSg5MCA2NSA2NSkiLz48cmVjdCB3aWR0aD0iNyIgaGVpZ2h0PSIyMCIgeD0iNDYuNSIgeT0iNDAiIGZpbGw9IiNBQkE5QUEiIHJ4PSI1IiByeT0iNSIgdHJhbnNmb3JtPSJyb3RhdGUoMTIwIDU4LjY2IDY1KSIvPjxyZWN0IHdpZHRoPSI3IiBoZWlnaHQ9IjIwIiB4PSI0Ni41IiB5PSI0MCIgZmlsbD0iI0IyQjJCMiIgcng9IjUiIHJ5PSI1IiB0cmFuc2Zvcm09InJvdGF0ZSgxNTAgNTQuMDIgNjUpIi8+PHJlY3Qgd2lkdGg9IjciIGhlaWdodD0iMjAiIHg9IjQ2LjUiIHk9IjQwIiBmaWxsPSIjQkFCOEI5IiByeD0iNSIgcnk9IjUiIHRyYW5zZm9ybT0icm90YXRlKDE4MCA1MCA2NSkiLz48cmVjdCB3aWR0aD0iNyIgaGVpZ2h0PSIyMCIgeD0iNDYuNSIgeT0iNDAiIGZpbGw9IiNDMkMwQzEiIHJ4PSI1IiByeT0iNSIgdHJhbnNmb3JtPSJyb3RhdGUoLTE1MCA0NS45OCA2NSkiLz48cmVjdCB3aWR0aD0iNyIgaGVpZ2h0PSIyMCIgeD0iNDYuNSIgeT0iNDAiIGZpbGw9IiNDQkNCQ0IiIHJ4PSI1IiByeT0iNSIgdHJhbnNmb3JtPSJyb3RhdGUoLTEyMCA0MS4zNCA2NSkiLz48cmVjdCB3aWR0aD0iNyIgaGVpZ2h0PSIyMCIgeD0iNDYuNSIgeT0iNDAiIGZpbGw9IiNEMkQyRDIiIHJ4PSI1IiByeT0iNSIgdHJhbnNmb3JtPSJyb3RhdGUoLTkwIDM1IDY1KSIvPjxyZWN0IHdpZHRoPSI3IiBoZWlnaHQ9IjIwIiB4PSI0Ni41IiB5PSI0MCIgZmlsbD0iI0RBREFEQSIgcng9IjUiIHJ5PSI1IiB0cmFuc2Zvcm09InJvdGF0ZSgtNjAgMjQuMDIgNjUpIi8+PHJlY3Qgd2lkdGg9IjciIGhlaWdodD0iMjAiIHg9IjQ2LjUiIHk9IjQwIiBmaWxsPSIjRTJFMkUyIiByeD0iNSIgcnk9IjUiIHRyYW5zZm9ybT0icm90YXRlKC0zMCAtNS45OCA2NSkiLz48L3N2Zz4=") no-repeat center; background-size: 100%; -webkit-animation: loading 1s infinite steps(12, end); animation: loading 1s infinite steps(12, end); }@keyframes loading { from { -webkit-transform: rotate3d(0, 0, 1, 0deg); transform: rotate3d(0, 0, 1, 0deg); } to { -webkit-transform: rotate3d(0, 0, 1, 360deg); transform: rotate3d(0, 0, 1, 360deg); } }.loading-text { font-size: 13px; margin: -5px 0 15px; }.loading-Dshow { display: block }.loading-Oshow { opacity: 1; }</style><i class="loading-icon"></i><p class="loading-text">数据加载中</p></div>',document.body.appendChild(t),this.isExist=!0,this.Sploading=t,this.show()},show:function(){if(this.isExist){var t=this;this.Sploading.className+=" loading-Dshow",this.startTime=Date.now(),this.len++,setTimeout(function(){t.Sploading.className+=" loading-Oshow"},1)}else this.creat()},hide:function(){if(0<this.len&&(this.len--,0===this.len))if(300<Date.now()-this.startTime)this.Sploading.className="loading-wrap loading-Dshow",this.Sploading.addEventListener("transitionend",this.removeEvent(this));else{var t=this;this.st=setTimeout(function(){t.len++,t.hide()},300-(Date.now()-this.startTime))}},removeEvent:function(t){t.Sploading.className="loading-wrap",t.Sploading.removeEventListener("transitionend",this.removeEvent)},remove:function(){document.body.removeChild(this.Sploading),this.isExist=!1,this.Sploading=null}};"object"==typeof i&&(e.exports=n)},{}],3:[function(t,e,i){!function(t,i){var e,n,o,a,r=document,s=window,c=r.documentElement,l=document.createElement("style");function d(){var t=c.getBoundingClientRect().width;i||(i=540),i<t&&(t=i);var e=100*t/750;l.innerHTML="html{font-size:"+e+"px;}"}(n="width=device-width,initial-scale=1,maximum-scale=1.0,user-scalable=no,viewport-fit=cover",e=r.querySelector('meta[name="viewport"]'))?e.setAttribute("content",n):((e=r.createElement("meta")).setAttribute("name","viewport"),e.setAttribute("content",n),c.firstElementChild?c.firstElementChild.appendChild(e):((a=r.createElement("div")).appendChild(e),r.write(a.innerHTML),a=null));(d(),c.firstElementChild)?c.firstElementChild.appendChild(l):((a=r.createElement("div")).appendChild(l),r.write(a.innerHTML),a=null);s.addEventListener("resize",function(){clearTimeout(o),o=setTimeout(d,300)},!1),s.addEventListener("pageshow",function(t){t.persisted&&(clearTimeout(o),o=setTimeout(d,300))},!1),"complete"===r.readyState?r.body.style.fontSize="14px":r.addEventListener("DOMContentLoaded",function(t){r.body.style.fontSize="14px"},!1)}(0,750)},{}],4:[function(t,e,i){var a=5e3;"object"==typeof i&&(e.exports=function(t,e,i){t||(t="这是一个toast"),e||(e=1e3);var n=document.createElement("div");function o(){i&&"function"==typeof i&&i(),document.body.removeChild(n),n.removeEventListener("transitionend",o)}n.className="toast-wrap",n.id="SpToast",n.innerHTML="<style>.toast-wrap { opacity: 0; position: fixed; left: 0; top: 0; width: 100%; height: 100%; z-index: "+a+++'; transition: opacity .3s; }.toast { height: 50px; line-height: 50px; margin: 180px 0 0 0; text-align: center; }.toast-text { display: inline-block; overflow: hidden; text-overflow: ellipsis; max-width: 325px; height: inherit; line-height: inherit; padding: 0 10px; font-size: 16px; background: rgba(17, 17, 17, 0.7); color: #fff; border-radius: 5px; }.opacity-1 { opacity: 1; }</style><div class="toast"><span id="SpToastText" class="toast-text">'+t+"</span></div>",document.body.appendChild(n),setTimeout(function(){n.className+=" opacity-1",setTimeout(function(){n.className="toast-wrap",n.addEventListener("transitionend",o)},e)},1)})},{}],5:[function(t,e,i){"use strict";t("../common/fastclick.js"),t("../common/rem.js");var n=a(t("../common/loading.js")),o=a(t("../common/toast.js"));function a(t){return t&&t.__esModule?t:{default:t}}!function(){function t(){this.$form=$("#form"),this.$submitBtn=$("#submit"),this.$sliderInput=[$("#sliderInput0"),$("#sliderInput1"),$("#sliderInput2"),$("#sliderInput3"),$("#sliderInput4")],this.$countScore=$("#countScore"),this.$countGrade=$("#countGrade"),this.courseInfo={},this.imgArr=[],this.init()}t.prototype={parse:function(t){return/^\d+$/.test(t)?+t:decodeURI(t)},assign:function(t,e){for(var i in e)t[i]=e[i];return t},bindSubmitClick:function(){var s=this;this.$submitBtn.click(function(){var t=s.$form.serialize(),a=0,r={};t.split("&").map(function(t,e){var i=t.split("="),n=i[0],o=i[1];r[n]=s.parse(o),""===o&&e<10?($("#input"+e).addClass("require"),a++):$("#input"+e).removeClass("require")}),0===a?(r=s.assign(r,s.courseInfo),s.submit(r)):(0,o.default)("请将信息填写完整")})},submit:function(e){if(n.default.show(),this.imgArr.length){var i=this;this.uploadImage(function(t){e.imgs=t.join(","),i.submitAjax(e)})}else e.imgs="",this.submitAjax(e)},submitAjax:function(t){$.ajax({url:"/api/commentCourse",type:"POST",data:t,success:function(t){n.default.hide(),0===t.code?location.replace("/comment_success"):401===t.code?(0,o.default)("请先登录再评价",function(){window.href="/comment"+location.search}):(0,o.default)(t.msg)},error:function(){n.default.hide(),(0,o.default)("网络异常，请稍后再试")}})},getCourseInfo:function(){n.default.show();var t=location.search.slice(1).split("=")[1],e=this;$.ajax({url:"/api/getCourse/"+t,success:function(t){console.log(t),n.default.hide(),0===t.code?e.setCourseInfo(t.data):(0,o.default)(t.msg)},error:function(){n.default.hide(),(0,o.default)("网络异常，请稍后再试")}})},setCourseInfo:function(t){$("#courseName").val(t.source_name),$("#teacherName").val(t.teacher_name),$("#className").val(t.class_name),$("#place").val(t.building+" "+t.address),$("#classes").text(this.parseTimeDetail(t.time)),this.saveCourseInfo(t),this.initSlider()},saveCourseInfo:function(t){this.courseInfo={class_id:t.ID,time_detail:t.time,building:t.building,classroom:t.address,time_day:t.day,time_week:t.week,grade:t.grade,course_id:t.source_id,teacher_id:-1,teacher_name:t.teacher_name,class_name:t.class_name,course_name:t.source_name}},parseTimeDetail:function(t){var e=t.split("");return"1"===e[2]?"第9.10节":"第"+e[1]+"."+e[3]+"节"},initSlider:function(){for(var t=0;t<5;t++)!function(n,o){$("#slider"+o).slider(function(t){var e=n.$sliderInput[o],i=Math.floor(t/100*e.data("total"));e.val(i),$("#sliderValue"+o).text(i),n.updateCountScore()})}(this,t)},updateCountScore:function(){for(var t=0,e=0;e<5;e++)t+=+this.$sliderInput[e].val();this.$countScore.val(t),this.updateCountGrade(t)},updateCountGrade:function(t){var e;e=t<60?"D":t<75?"C":t<90?"B":"A",this.$countGrade.val(e)},watchAdviseLen:function(){var t=$("#adviseLen");$("#otherAdvise").on("input",function(){t.text($(this).val().length)})},getSnConfig:function(){var e=this;$.ajax({type:"get",url:"/api/getSnConfig?url="+location.href,success:function(t){0===t.code&&e.wechatConfig(t.data)},error:function(){(0,o.default)("网络异常，请稍后再试")}})},wechatConfig:function(t){wx.config({beta:!0,appId:"wx6219dbfa9b86489e",timestamp:t.timestamp,nonceStr:t.noncestr,signature:t.signature,jsApiList:["chooseImage","uploadImage","getLocalImgData"]})},uploadImage:function(e){wx.uploadImage({localId:this.imgArr,success:function(t){console.log("res.serverId",t.serverId),e(t.serverId)}})},getLocalImgData:function(t){wx.getLocalImgData({localId:t,success:function(t){that.imgArr=t.localData,that.renderUploadView(t.localData)}})},renderUploadView:function(t){var e=t.map(function(t){return alert(t),'<li class="weui-uploader__file" style="background-image:url('+t+')"></li>'}).join("");$("#uploaderFiles").html(e),this.setImgLength(t.length)},setImgLength:function(t){$("#imgLength").text(t)},bindUploadClick:function(){var e=this;$("#uploaderInput").click(function(){wx.chooseImage({count:5,success:function(t){"ios"===e.getPhoneType()?e.getLocalImgData(t.localIds):(e.imgArr=t.localIds,e.renderUploadView(t.localIds))}})})},getPhoneType:function(){return/iPhone/i.test(navigator.userAgent)?"ios":"andriod"},init:function(){this.getCourseInfo(),this.bindSubmitClick(),this.watchAdviseLen(),this.getSnConfig(),this.bindUploadClick()}},$(function(){new t})}()},{"../common/fastclick.js":1,"../common/loading.js":2,"../common/rem.js":3,"../common/toast.js":4}]},{},[5]);